---
title: MCP Database Access
description: Give Claude access to SQLite databases
---

# MCP Database Access

```tsx
#!/usr/bin/env smithers

import {
  createSmithersRoot,
  createSmithersDB,
  SmithersProvider,
  Claude,
  Sqlite,
} from "smithers-orchestrator";

async function main() {
  const db = createSmithersDB({ path: ".smithers/data-analysis" });
  const executionId = db.execution.start("Data Analysis", "data-analysis.tsx");

  function DataAnalysis() {
    return (
      <SmithersProvider db={db} executionId={executionId}>
        <Claude
          model="sonnet"
          maxTurns={10}
          onFinished={(result) => console.log(result.output)}
        >
          <Sqlite path="./ecommerce.db" readOnly>
            users(id, name, email, created_at, country)
            orders(id, user_id, total, status, created_at)
            order_items(id, order_id, product_id, quantity, price)
            products(id, name, category, price, stock)
          </Sqlite>

          Generate a business report: revenue by month, top customers,
          best-selling products. Save to reports/business-report.md
        </Claude>
      </SmithersProvider>
    );
  }

  try {
    const root = createSmithersRoot();
    await root.mount(DataAnalysis);
    db.execution.complete(executionId, { summary: "Data analysis complete" });
  } catch (err) {
    const error = err instanceof Error ? err : new Error(String(err));
    db.execution.fail(executionId, error.message);
    throw error;
  } finally {
    db.close();
  }
}

main();
```

## Run It

```bash
bun data-analysis.tsx
```

## What's Happening

- **Sqlite**: Exposes database to Claude via MCP tools
- **readOnly**: Prevents accidental mutations
- **Schema in children**: Claude sees table structure in system prompt

## Multiple Databases

```tsx
<Claude model="sonnet" maxTurns={15}>
  <Sqlite path="./users.db" readOnly>User database: users, profiles</Sqlite>
  <Sqlite path="./analytics.db" readOnly>Analytics: events, sessions</Sqlite>

  Cross-reference: find users who signed up but never logged an event.
</Claude>
```

## Workflow with Database

```tsx
function DataWorkflow() {
  const { db, reactiveDb } = useSmithers();
  const { data: phase } = useQueryValue<string>(
    reactiveDb, "SELECT value FROM state WHERE key = 'phase'"
  );

  return (
    <>
      <If condition={(phase ?? "analyze") === "analyze"}>
        <Claude
          model="sonnet"
          onFinished={(result) => {
            db.state.set("findings", result.output);
            db.state.set("phase", "report");
          }}
        >
          <Sqlite path="./data.db" readOnly>Sales database.</Sqlite>
          Analyze Q4 sales performance.
        </Claude>
      </If>

      <If condition={phase === "report"}>
        <Claude allowedTools={["Write"]} onFinished={() => db.state.set("phase", "done")}>
          Create report from: {db.state.get("findings")}
          Save to reports/q4-analysis.md
        </Claude>
      </If>
    </>
  );
}
```
