---
title: Tasks API
description: Task tracking for Ralph iteration management
---

# Tasks API

```tsx
const taskId = db.tasks.start("claude", "code-analyzer");
// ... execute component ...
db.tasks.complete(taskId);
```

## Contract

- **Sync:** All methods synchronous except `withTask` (returns Promise)
- **Scope:** Methods operate on current execution

## Methods

| Method | Signature | Description |
|--------|-----------|-------------|
| `start` | `(componentType: string, componentName?: string) => string` | Start task |
| `complete` | `(id: string) => void` | Mark complete |
| `fail` | `(id: string) => void` | Mark failed (does not stop orchestration) |
| `getRunningCount` | `(iteration: number) => number` | Count running tasks |
| `getTotalCount` | `(iteration: number) => number` | Count all tasks |
| `list` | `() => Task[]` | List all tasks |
| `getCurrentIteration` | `() => number` | Get current Ralph iteration |
| `withTask` | `<T>(type: string, name: string, fn: () => T) => Promise<T>` | Execute within task lifecycle |

## Usage

```tsx
const taskId = db.tasks.start('claude', 'reviewer');
try {
  // execute...
  db.tasks.complete(taskId);
} catch {
  db.tasks.fail(taskId);
}

// Check iteration progress
const iteration = db.tasks.getCurrentIteration();
const running = db.tasks.getRunningCount(iteration);
const total = db.tasks.getTotalCount(iteration);
if (running === 0 && total > 0) {
  console.log("All tasks completed");
}
```

## Types

```tsx
interface Task {
  id: string;
  execution_id: string;
  iteration: number;
  component_type: string;
  component_name: string | null;
  status: 'running' | 'completed' | 'failed';
  started_at: string;
  completed_at: string | null;
  duration_ms: number | null;
}
```

## Related

- [Phases API](/api-reference/phases)
- [Steps API](/api-reference/steps)
