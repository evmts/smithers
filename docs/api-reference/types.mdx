---
title: TypeScript Types
description: Complete type definitions for Smithers
---

# TypeScript Types

Smithers is written in TypeScript and exports comprehensive type definitions.

## Component Props

### ClaudeProps

Props for the `<Claude>` component.

```typescript
interface ClaudeProps<T = any> {
  /** Tools to make available */
  tools?: Tool[]

  /** Called when Claude completes successfully */
  onFinished?: (output: T) => void

  /** Called when execution fails */
  onError?: (error: Error | ExecutionError) => void

  /** Called when a tool fails (when continueOnToolFailure is enabled) */
  onToolError?: (toolName: string, error: Error, input: unknown) => void

  /** Override the Claude model */
  model?: string

  /** System prompt for the conversation */
  system?: string

  /** Maximum number of tool execution iterations (default: 10) */
  maxToolIterations?: number

  /** Enable streaming mode */
  stream?: boolean

  /** Callback for streaming chunks */
  onStream?: (chunk: StreamChunk) => void

  /** MCP servers to connect to for additional tools */
  mcpServers?: MCPServerConfig[]

  /** Number of retries for Claude API calls (default: 3) */
  retries?: number

  /** Tool retry configuration for failed tool executions */
  toolRetry?: ToolRetryOptions

  /** Prompt content */
  children: ReactNode
}

interface ToolRetryOptions {
  /** Maximum number of retries for a failed tool (default: 2) */
  maxRetries?: number

  /** Base delay in ms between retries (default: 500) */
  baseDelayMs?: number

  /** Whether to use exponential backoff (default: true) */
  exponentialBackoff?: boolean

  /** Tool names to skip on failure (continue with other tools) */
  skipOnFailure?: string[]

  /** Whether to continue execution if some tools fail (default: false) */
  continueOnToolFailure?: boolean
}
```

### SubagentProps

Props for the `<Subagent>` component.

```typescript
interface SubagentProps {
  /** Identifier for logging and debugging */
  name?: string

  /** Run concurrently with siblings (default: true) */
  parallel?: boolean

  /** Content to execute */
  children: ReactNode
}
```

### PhaseProps

Props for the `<Phase>` component.

```typescript
interface PhaseProps {
  /** Phase identifier */
  name: string

  /** Mark phase as already completed (skipped by Ralph loop) */
  completed?: boolean

  /** Phase content */
  children: ReactNode
}
```

### StepProps

Props for the `<Step>` component.

```typescript
interface StepProps {
  /** Mark step as already completed (skipped by Ralph loop) */
  completed?: boolean

  /** Step description */
  children: ReactNode
}
```

### PersonaProps

Props for the `<Persona>` component.

```typescript
interface PersonaProps {
  /** Role or title */
  role: string

  /** Additional persona details */
  children?: ReactNode
}
```

### ConstraintsProps

Props for the `<Constraints>` component.

```typescript
interface ConstraintsProps {
  /** Constraint rules */
  children: ReactNode
}
```

### OutputFormatProps

Props for the `<OutputFormat>` component.

```typescript
interface OutputFormatProps {
  /** JSON Schema for expected output */
  schema?: JSONSchema

  /** Human-readable format description */
  children?: ReactNode
}
```

## Tool Types

```typescript
interface Tool {
  /** Unique tool identifier */
  name: string

  /** Human-readable description */
  description: string

  /** JSON Schema defining the tool's input parameters */
  input_schema?: ToolInputSchema

  /** Optional function to execute the tool (for MCP integration) */
  execute?: (args: unknown) => Promise<unknown>
}

interface ToolInputSchema {
  type: 'object'
  properties?: Record<string, unknown>
  required?: string[]
  [key: string]: unknown
}
```

Example tool definition:

```typescript
const searchTool: Tool = {
  name: 'web-search',
  description: 'Search the web for information',
  input_schema: {
    type: 'object',
    properties: {
      query: {
        type: 'string',
        description: 'Search query',
      },
      limit: {
        type: 'number',
        description: 'Maximum results',
      },
    },
    required: ['query'],
  },
  execute: async (args) => {
    // Implementation
    return { results: [] }
  },
}
```

## Execution Types

### ExecuteOptions

Options for `executePlan`.

```typescript
interface ExecuteOptions {
  /** Skip plan approval prompts */
  autoApprove?: boolean

  /** Maximum frames before terminating (default: 100) */
  maxFrames?: number

  /** Total timeout in milliseconds */
  timeout?: number

  /** Show detailed execution logs */
  verbose?: boolean

  /** Enable mock mode (no real API calls) */
  mockMode?: boolean

  /** Override the Claude model */
  model?: string

  /** Maximum tokens for Claude responses */
  maxTokens?: number

  /** Called before each frame with the plan XML */
  onPlan?: (xml: string, frame: number) => void

  /** Called after each frame completes */
  onFrame?: (result: FrameResult) => void

  /**
   * Custom prompt function for Human component approval.
   * If not provided, Human nodes will automatically approve.
   * @param message - The message to display to the user
   * @param content - The content from the Human component's children
   * @returns Promise<boolean> - true if approved, false if rejected
   */
  onHumanPrompt?: (message: string, content: string) => Promise<boolean>

  /** Debug observability options */
  debug?: DebugOptions
}
```

### ExecutionResult

Result returned by `executePlan`.

```typescript
interface ExecutionResult<T = any> {
  /** Final output from the last Claude call */
  output: T

  /** Total number of frames executed */
  frames: number

  /** Total duration in milliseconds */
  totalDuration: number

  /** Detailed history of each frame */
  history: FrameResult[]

  /** List of MCP servers that were connected */
  mcpServers?: string[]
}
```

### FrameResult

Information about a completed frame.

```typescript
interface FrameResult {
  /** Frame number (1-indexed) */
  frame: number

  /** XML plan for this frame */
  plan: string

  /** Names of executed nodes */
  executedNodes: string[]

  /** Whether state changes occurred */
  stateChanges: boolean

  /** Frame duration in milliseconds */
  duration: number
}
```

## Internal Types

These types are used internally but exported for advanced use cases.

### SmithersNode

Internal node representation.

```typescript
interface SmithersNode {
  /** Node type: 'claude', 'subagent', 'phase', etc. */
  type: string

  /** Component props */
  props: Record<string, any>

  /** Child nodes */
  children: SmithersNode[]

  /** Parent reference */
  parent: SmithersNode | null

  /** Execution state */
  _execution?: ExecutionState
}

interface ExecutionState {
  status: 'pending' | 'running' | 'complete' | 'error'
  result?: any
  error?: Error
  /** Hash of node content for change detection */
  contentHash?: string
}
```

### SmithersRoot

Root container for the renderer.

```typescript
interface SmithersRoot {
  /** Render a React element to SmithersNode tree */
  render(element: ReactElement): Promise<SmithersNode>

  /** Clean up the root */
  unmount(): void

  /** Get the current tree (may be null if unmounted) */
  getTree(): SmithersNode | null
}
```

## Usage Examples

### Typed Agent Component

```tsx
import type { ClaudeProps, Tool } from 'smithers'

interface AnalysisResult {
  summary: string
  score: number
  issues: Array<{ severity: string; message: string }>
}

interface AnalyzerProps {
  code: string
  strict?: boolean
}

function Analyzer({ code, strict = false }: AnalyzerProps) {
  const handleResult = (result: AnalysisResult) => {
    if (result.score < 0.5) {
      console.warn('Low quality score:', result.score)
    }
  }

  return (
    <Claude<AnalysisResult>
      tools={[filesystem]}
      onFinished={handleResult}
    >
      Analyze this code: {code}
      {strict && <Constraints>Apply strict standards</Constraints>}
    </Claude>
  )
}
```

### Typed Tool Definition

```tsx
import type { Tool } from 'smithers'

const searchTool: Tool = {
  name: 'web-search',
  description: 'Search the web for information',
  input_schema: {
    type: 'object',
    properties: {
      query: {
        type: 'string',
        description: 'Search query',
      },
      limit: {
        type: 'number',
        description: 'Maximum results',
      },
    },
    required: ['query'],
  },
}
```

### Typed Execution

```tsx
import { executePlan } from 'smithers'
import type { ExecutionResult, ExecuteOptions } from 'smithers'

interface ReportOutput {
  title: string
  sections: string[]
}

const options: ExecuteOptions = {
  autoApprove: true,
  maxFrames: 20,
  onFrame: (result) => {
    console.log(`Frame ${result.frame}: ${result.executedNodes.length} nodes`)
  },
}

const result: ExecutionResult<ReportOutput> = await executePlan(
  <ReportAgent topic="AI" />,
  options
)

console.log(result.output.title)
console.log(result.output.sections.length)
```

## JSX Types

Smithers extends React's JSX types. Import the type definitions:

```json
// tsconfig.json
{
  "compilerOptions": {
    "types": ["smithers/jsx"]
  }
}
```

This enables proper type checking for Smithers components in JSX.
