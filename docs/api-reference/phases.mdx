---
title: Phases API
description: Phase tracking for workflow organization
---

# Phases API

```tsx
const phaseId = db.phases.start("implementation", 0);
// ... do work ...
db.phases.complete(phaseId);
```

## Contract

- **Sync:** All methods are synchronous
- **Return shape:** snake_case fields, timestamps as ISO strings

## Methods

| Method | Signature | Description |
|--------|-----------|-------------|
| `start` | `(name: string, iteration?: number) => string` | Start a phase |
| `complete` | `(id: string) => void` | Mark complete |
| `fail` | `(id: string) => void` | Mark failed |
| `current` | `() => Phase \| null` | Get active phase |
| `list` | `(executionId: string) => Phase[]` | List phases for execution |

## Component Usage

```tsx
<SmithersProvider db={db} executionId={executionId}>
  <Ralph id="workflow" condition={() => !isDone} maxIterations={5}>
    <Phase name="research">
      <Step name="research">
        <Claude>Research the topic.</Claude>
      </Step>
    </Phase>

    <Phase name="implementation">
      <Step name="implement">
        <Claude>Implement the feature.</Claude>
      </Step>
    </Phase>
  </Ralph>
</SmithersProvider>
```

## Multi-Iteration

Phases track iteration numbers for looping workflows. Use `<Ralph>` or `<While>` for iteration:

```tsx
<SmithersProvider db={db} executionId={executionId}>
  <Ralph id="workflow" condition={() => !isDone} maxIterations={5}>
    <Phase name="implement">
      {/* Tracked with iteration 0, 1, 2, etc. */}
      <Claude>Implement the feature.</Claude>
    </Phase>
  </Ralph>
</SmithersProvider>
```

Query by iteration:

```tsx
const phases = db.phases.list(executionId);
const iteration2 = phases.filter(p => p.iteration === 2);
```

## Types

```tsx
interface Phase {
  id: string;
  execution_id: string;
  name: string;
  iteration: number;
  status: 'pending' | 'running' | 'completed' | 'skipped' | 'failed';
  started_at?: Date;
  completed_at?: Date;
  duration_ms?: number;
  agents_count: number;
  created_at: Date;
}
```

## Related

- [Steps API](/api-reference/steps)
- [Phase Component](/components/phase)
