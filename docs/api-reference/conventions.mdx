---
title: API Conventions
description: Shared contracts for the database API
---

# API Conventions

## Import Paths

```typescript
// Main entry - components, hooks, reconciler
import { Claude, Amp, SmithersProvider, useMount } from "smithers-orchestrator"

// Database - reactive hooks, full DB types
import { useQueryValue, ReactiveDatabase, type SmithersDB } from "smithers-orchestrator/db"

// JSX runtime (tsconfig handles this)
import {} from "smithers-orchestrator/jsx-runtime"
```

Main entry re-exports `createSmithersDB` and `SmithersDB` type. Use `/db` subpath for reactive hooks (`useQuery`, `useQueryValue`, `useMutation`).

## Sync vs Async

All `db.*` methods are synchronous. Exceptions documented explicitly.

## Casing

- Parameters: **camelCase**
- Return values: **snake_case** (matches DB columns)

## Timestamps

All timestamp fields are **ISO 8601 strings** (e.g., `"2025-01-21T12:00:00.000Z"`).

Some modules internally map to `Date` objects for convenience:
- `db.execution`, `db.agents`, `db.artifacts`, `db.vcs`

All other modules return raw ISO strings:
- `db.state`, `db.memories`, `db.phases`, `db.steps`, `db.tasks`, `db.tools`, `db.human`

To convert: `new Date(record.created_at)`

## Status Vocabulary

Common: `pending`, `running`, `completed`, `failed`, `cancelled`

Module-specific:
- Phases/Steps: `skipped`
- Human: `approved`, `rejected`, `timeout`

## Execution Scope

These require current execution (`db.execution.start()`):
`db.phases`, `db.steps`, `db.agents`, `db.tools`, `db.tasks`, `db.artifacts`, `db.human`, `db.vcs`

## JSON Parsing

Parsed fields (returned as objects):

| Module | Fields |
|--------|--------|
| `db.tools` | `input` |
| `db.agents` | `result_structured`, `stream_summary` |
| `db.artifacts` | `metadata` |
| `db.human` | `options`, `response`, `session_config` |
| `db.vcs` | `files_changed`, `files_modified`, `issues`, `approvals`, `data` |

Raw JSON (caller parses): `db.state.history` (`old_value`, `new_value`)
