---
title: Step
description: Individual step within a workflow phase
---

# Step Component

The `<Step>` component represents an individual step within a workflow phase, providing fine-grained tracking.

## Basic Usage

```tsx
import { Step } from "smithers-orchestrator";

<Phase name="Implementation">
  <Step name="Create API">
    <Claude>Create the API endpoint.</Claude>
  </Step>
  <Step name="Add Tests">
    <Claude>Write tests for the API.</Claude>
  </Step>
</Phase>
```

## Props

<ParamField path="name" type="string">
  Name of the step for tracking and logging.
</ParamField>

<ParamField path="children" type="ReactNode" required>
  Content to execute within the step.
</ParamField>

### VCS Integration

<ParamField path="snapshotBefore" type="boolean" default="false">
  Create a JJ snapshot before step execution. Useful for rollback if step fails.
  
  <Info>Requires JJ to be configured in the repository. Logs a warning if JJ is unavailable.</Info>
</ParamField>

<ParamField path="snapshotAfter" type="boolean" default="false">
  Create a JJ snapshot after step completes successfully.
</ParamField>

<ParamField path="commitAfter" type="boolean" default="false">
  Create a JJ commit after step completes. The commit is logged to the database via `db.vcs.logCommit()`.
</ParamField>

<ParamField path="commitMessage" type="string">
  Custom commit message when `commitAfter` is true. Defaults to `"Step: {step-name}"`.
</ParamField>

### Callbacks

<ParamField path="onStart" type="() => void">
  Called when the step starts executing.
</ParamField>

<ParamField path="onComplete" type="() => void">
  Called when the step completes successfully.
</ParamField>

<ParamField path="onError" type="(error: Error) => void">
  Called when the step encounters an error.
</ParamField>

## VCS Integration

Steps can automatically create JJ snapshots and commits:

```tsx
<Phase name="Implementation">
  <Step 
    name="Implement Feature"
    snapshotBefore
    commitAfter
    commitMessage="feat: implement user authentication"
    onComplete={() => console.log("Feature implemented")}
  >
    <Claude>Implement the authentication system.</Claude>
  </Step>
</Phase>
```

<Info>
VCS operations fail gracefully - if JJ is not configured or an operation fails, a warning is logged but the step continues. This prevents VCS issues from blocking workflow execution.
</Info>

## Structured Workflow

```tsx
<SmithersProvider db={db} executionId={executionId} globalTimeout={3600000}>
  <Phase name="Setup">
    <Step name="Check Environment">
      <Claude allowedTools={["Bash"]}>
        Verify dependencies are installed.
      </Claude>
    </Step>
    <Step name="Create Branch">
      <Claude allowedTools={["Bash"]}>
        Create a feature branch.
      </Claude>
    </Step>
  </Phase>

  <Phase name="Development">
    <Step name="Implement Feature">
      <Claude allowedTools={["Edit", "Write"]}>
        Write the code.
      </Claude>
    </Step>
    <Step name="Add Tests">
      <Claude allowedTools={["Write"]}>
        Create test files.
      </Claude>
    </Step>
  </Phase>

  <Phase name="Verification">
    <Step name="Run Tests">
      <Claude allowedTools={["Bash"]}>
        Execute the test suite.
      </Claude>
    </Step>
    <Step name="Run Linter">
      <Claude allowedTools={["Bash"]}>
        Check code style.
      </Claude>
    </Step>
  </Phase>
</SmithersProvider>
```

## Database Tracking

Steps are tracked in the database:

```tsx
const steps = await db.steps.list({ executionId });
// [
//   { id: "s1", name: "Check Environment", status: "complete", ... },
//   { id: "s2", name: "Create Branch", status: "complete", ... },
//   { id: "s3", name: "Implement Feature", status: "running", ... },
// ]
```

## Related

<CardGroup cols={2}>
  <Card title="Phase" icon="list" href="/components/phase">
    Group steps into phases
  </Card>
  <Card title="SmithersProvider" icon="sitemap" href="/components/smithers-provider">
    Top-level control
  </Card>
</CardGroup>
