---
title: Stop Component
description: Halt the Ralph Wiggum loop explicitly when a condition is met
---

# Stop Component

The `<Stop>` component signals the Ralph Wiggum loop to halt execution. When rendered in the tree, it prevents further iterations of the loop, allowing you to explicitly stop execution based on custom conditions.

## Basic Usage

```tsx
import { Claude, Stop } from '@evmts/smithers'

function ConditionalAgent({ shouldStop }) {
  return (
    <>
      <Claude>
        Do some work...
      </Claude>
      {shouldStop && <Stop reason="Work complete" />}
    </>
  )
}
```

## Props

<ParamField path="reason" type="string">
  Optional reason for stopping execution. Appears in verbose logs and can be used for debugging.

  ```tsx
  <Stop reason="Maximum iterations reached" />
  <Stop reason="All tasks completed" />
  ```
</ParamField>

<ParamField path="children" type="JSX.Element">
  Optional children content (typically not used).
</ParamField>

## Use Cases

### Iteration Limits

Stop execution after a certain number of iterations:

```tsx
import { createStore } from 'solid-js/store'

function LimitedAgent() {
  const [state, setState] = createStore({ count: 0 })
  const increment = () => setState('count', c => c + 1)
  
  return () => {
    const shouldStop = state.count >= 5

    return (
      <>
        <Claude onFinished={increment}>
          Iteration {state.count}: Do some work
        </Claude>
        {shouldStop && <Stop reason="Reached iteration limit" />}
      </>
    )
  }
}
```

### Completion Conditions

Stop when a specific condition is met:

```tsx
import { createSignal } from 'solid-js'

function SearchAgent(props) {
  const [found, setFound] = createSignal(false)
  const [result, setResult] = createSignal(null)

  return () => {
    if (found()) {
      return (
        <>
          <div>Found: {JSON.stringify(result())}</div>
          <Stop reason="Target found" />
        </>
      )
    }

    return (
      <Claude
        tools={[searchTool]}
        onFinished={(output) => {
          if (output.found) {
            setResult(output.data)
            setFound(true)
          }
        }}
      >
        Search for: {props.query}
      </Claude>
    )
  }
}
```

### Multi-Phase Workflows with Early Exit

Exit early when an error phase is reached:

```tsx
import { createSignal } from 'solid-js'

function WorkflowAgent() {
  const [phase, setPhase] = createSignal('start')

  return () => {
    const p = phase()

    if (p === 'error') {
      return (
        <>
          <Claude>Log the error and clean up</Claude>
          <Stop reason="Error recovery complete" />
        </>
      )
    }

    if (p === 'done') {
      return <Stop reason="Workflow complete" />
    }

    // ... normal workflow phases
    return <Claude onFinished={() => setPhase('done')}>Work</Claude>
  }
}
```

## Behavior

When a `<Stop>` component is present in the rendered tree:

1. The current frame completes any already-running executions
2. The loop halts before starting any new executions
3. `executePlan` returns with the results collected so far

```tsx
const result = await executePlan(() => <MyAgent />, {
  onFrame: (frame) => {
    console.log(`Frame ${frame.frame} completed`)
  }
})

// result.frames will reflect how many frames executed before Stop
console.log(`Stopped after ${result.frames} frames`)
```

## Comparison with No Pending Nodes

The Ralph Wiggum loop naturally terminates when there are no more pending `<Claude>` nodes. Use `<Stop>` when you want to:

1. **Exit early**: Stop before all possible work is done
2. **Signal intent**: Make it clear why execution stopped
3. **Conditional halting**: Stop based on custom logic

```tsx
// Natural termination - no Stop needed
function NaturalEnd() {
  const [done, setDone] = createSignal(false)

  return () => {
    if (done()) {
      return <div>Complete</div> // No Claude nodes, loop ends
    }

    return <Claude onFinished={() => setDone(true)}>Do work</Claude>
  }
}

// Explicit Stop - when you want to signal intent or exit mid-workflow
function ExplicitStop() {
  const [phase, setPhase] = createSignal('working')

  return () => {
    const p = phase()
    return (
      <>
        <Claude onFinished={() => setPhase('done')}>Do work</Claude>
        {p === 'done' && <Stop reason="Work complete" />}
      </>
    )
  }
}
```

## Related

<CardGroup cols={2}>
  <Card title="Human Component" icon="user" href="/components/human">
    Pause execution for human approval
  </Card>
  <Card title="Ralph Wiggum Loop" icon="rotate" href="/concepts/ralph-wiggum-loop">
    Understand the execution model
  </Card>
</CardGroup>
