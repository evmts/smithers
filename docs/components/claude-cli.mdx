---
title: ClaudeCli Component
description: Execute prompts using the Claude CLI with your Claude Code subscription
---

# ClaudeCli Component

The `<ClaudeCli>` component executes prompts using the Claude CLI (`claude` command) instead of the Anthropic SDK. This allows you to use your Claude Code subscription for agent workflows, avoiding per-token API costs.

## When to Use ClaudeCli vs Claude

| Feature | `<Claude>` | `<ClaudeCli>` |
|---------|------------|---------------|
| Billing | API (per-token) | Claude Code subscription |
| Custom tools | Full control | CLI built-in tools |
| Streaming | Configurable | N/A |
| MCP servers | Configurable | Uses CLI config |
| Tool retries | Configurable | CLI handles |
| Best for | Production, fine control | Development, prototyping |

## Basic Usage

```tsx
import { ClaudeCli } from 'smithers'

function SimpleAgent() {
  return (
    <ClaudeCli>
      Analyze the current directory structure and summarize what this project does.
    </ClaudeCli>
  )
}
```

## Props

<ParamField path="onFinished" type="(output: string) => void">
  Callback invoked when Claude CLI completes execution. Output is always a string.

  ```tsx
  <ClaudeCli onFinished={(result) => {
    console.log('Agent completed:', result)
    setData(result)
  }}>
    Summarize the README.md file.
  </ClaudeCli>
  ```
</ParamField>

<ParamField path="onError" type="(error: Error) => void">
  Callback invoked if execution fails.

  ```tsx
  <ClaudeCli
    onError={(error) => {
      console.error('Agent failed:', error)
      setError(error)
    }}
  >
    Perform a risky operation.
  </ClaudeCli>
  ```
</ParamField>

<ParamField path="model" type="string">
  Override the Claude model to use. Maps to `--model` flag.

  ```tsx
  <ClaudeCli model="opus">
    Complex reasoning task requiring the most capable model.
  </ClaudeCli>
  ```
</ParamField>

<ParamField path="cwd" type="string">
  Working directory for the CLI command. Defaults to current working directory.

  ```tsx
  <ClaudeCli cwd="/path/to/project">
    Analyze this project's package.json.
  </ClaudeCli>
  ```
</ParamField>

<ParamField path="allowedTools" type="string[]">
  List of tools the CLI is allowed to use. Maps to `--allowedTools` flag.

  ```tsx
  <ClaudeCli allowedTools={['Read', 'Glob', 'Grep']}>
    Search for all TypeScript files that import React.
  </ClaudeCli>
  ```
</ParamField>

<ParamField path="maxTurns" type="number">
  Maximum number of agentic turns. Maps to `--max-turns` flag.

  ```tsx
  <ClaudeCli maxTurns={5}>
    Complete this task in at most 5 steps.
  </ClaudeCli>
  ```
</ParamField>

<ParamField path="systemPrompt" type="string">
  System prompt to use. Maps to `--system-prompt` flag.

  ```tsx
  <ClaudeCli systemPrompt="You are a security expert.">
    Review this code for vulnerabilities.
  </ClaudeCli>
  ```
</ParamField>

<ParamField path="children" type="ReactNode" required>
  The prompt content. Can be plain text, markdown, or nested components.
</ParamField>

## Children as Prompt

Everything inside `<ClaudeCli>` becomes the prompt, just like `<Claude>`:

```tsx
<ClaudeCli>
  <Persona role="Senior Engineer">
    You have 10 years of experience with distributed systems.
  </Persona>

  <Constraints>
    - Focus on performance issues
    - Suggest concrete fixes with code examples
  </Constraints>

  Analyze the codebase for performance bottlenecks.
</ClaudeCli>
```

## State-Driven Rendering

Use React state to control the workflow:

```tsx
import { create } from 'zustand'

const useStore = create((set) => ({
  phase: 'research' as 'research' | 'implement',
  findings: '',
  setFindings: (findings) => set({ findings, phase: 'implement' }),
}))

function DeveloperAgent({ task }) {
  const { phase, findings, setFindings } = useStore()

  if (phase === 'research') {
    return (
      <ClaudeCli onFinished={setFindings}>
        Research the codebase to understand how to: {task}

        Focus on:
        - Existing patterns and conventions
        - Related files and functions
        - Dependencies and constraints
      </ClaudeCli>
    )
  }

  return (
    <ClaudeCli onFinished={() => console.log('Done!')}>
      Implement the following task: {task}

      Based on your research:
      {findings}
    </ClaudeCli>
  )
}
```

## Example: Code Review with CLI

```tsx
function CodeReviewAgent({ files }) {
  return (
    <ClaudeCli
      allowedTools={['Read', 'Glob', 'Grep']}
      maxTurns={10}
    >
      <Persona role="Code Reviewer">
        You are a thorough code reviewer focused on:
        - Code quality and maintainability
        - Potential bugs and edge cases
        - Performance implications
      </Persona>

      Review these files: {files.join(', ')}

      <OutputFormat>
        For each issue found, provide:
        - File and line number
        - Issue description
        - Suggested fix
      </OutputFormat>
    </ClaudeCli>
  )
}
```

## CLI Configuration

The `<ClaudeCli>` component uses the `claude` CLI command which respects your Claude Code configuration:

- **Authentication**: Uses your Claude Code subscription (logged in via `claude login`)
- **MCP Servers**: Uses servers configured in your Claude Code settings
- **Permissions**: Respects your configured allowed/disallowed tools

## How It Works

Under the hood, `<ClaudeCli>` spawns a `claude` process:

```bash
claude --print --output-format text "Your prompt here"
```

The `--print` flag runs non-interactively, and `--output-format text` ensures clean output parsing.

## Limitations

Compared to `<Claude>`, the CLI component has some limitations:

1. **No custom tool definitions** - Can only use CLI's built-in tools
2. **No streaming callbacks** - Output is returned when complete
3. **No MCP server configuration** - Uses CLI's configured servers
4. **String output only** - No automatic JSON parsing

For production use cases requiring fine-grained control, use `<Claude>` instead.

## Related Components

<CardGroup cols={2}>
  <Card title="Claude" icon="bolt" href="/components/claude">
    Full-featured SDK-based execution
  </Card>
  <Card title="Subagent" icon="layer-group" href="/components/subagent">
    Run components in parallel
  </Card>
</CardGroup>
