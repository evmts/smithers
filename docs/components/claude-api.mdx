---
title: ClaudeApi Component
description: Direct API access for custom tool implementations
---

# ClaudeApi Component

The `<ClaudeApi>` component uses the Anthropic API SDK directly, giving you full control over API calls with custom tool implementations. Use this when you need to define your own tools rather than using the built-in Agent SDK tools.

## Basic Usage

```tsx
import { ClaudeApi } from 'smithers'

<ClaudeApi
  tools={[myCustomTool]}
  system="You are a helpful assistant"
  onFinished={(result) => setResult(result)}
>
  Analyze this data
</ClaudeApi>
```

## Props

<ParamField path="tools" type="Tool[]">
  Array of custom tool definitions. Unlike `<Claude>`, you provide your own tool implementations.

  ```tsx
  const searchTool = {
    name: 'search',
    description: 'Search for information',
    input_schema: {
      type: 'object',
      properties: {
        query: { type: 'string' }
      },
      required: ['query']
    },
    execute: async ({ query }) => {
      // Your implementation
      return searchResults
    }
  }

  <ClaudeApi tools={[searchTool]}>
    Find information about...
  </ClaudeApi>
  ```
</ParamField>

<ParamField path="system" type="string">
  System prompt for the API call.

  ```tsx
  <ClaudeApi system="You are a data analyst expert.">
    Analyze this dataset...
  </ClaudeApi>
  ```
</ParamField>

<ParamField path="model" type="string" default="claude-sonnet-4-20250514">
  Override the Claude model to use.

  ```tsx
  <ClaudeApi model="claude-opus-4-20250514">
    Complex reasoning task...
  </ClaudeApi>
  ```
</ParamField>

<ParamField path="onFinished" type="(output: T) => void">
  Callback invoked when execution completes.

  ```tsx
  <ClaudeApi onFinished={(result) => {
    console.log('API call completed:', result)
  }}>
    Process this request...
  </ClaudeApi>
  ```
</ParamField>

<ParamField path="onError" type="(error: Error) => void">
  Callback invoked if execution fails.

  ```tsx
  <ClaudeApi onError={(error) => {
    console.error('API call failed:', error)
  }}>
    Risky operation...
  </ClaudeApi>
  ```
</ParamField>

<ParamField path="children" type="ReactNode" required>
  The prompt content.
</ParamField>

## When to Use ClaudeApi vs Claude

| Use Case | Component |
|----------|-----------|
| Built-in tools (Read, Edit, Bash, etc.) | `<Claude>` |
| Custom tool implementations | `<ClaudeApi>` |
| Agent SDK features (permissions, agents) | `<Claude>` |
| Direct API control | `<ClaudeApi>` |
| Per-token billing visibility | `<ClaudeApi>` |

## Custom Tool Example

Define custom tools with execute handlers:

```tsx
const databaseTool = {
  name: 'query_database',
  description: 'Execute a SQL query against the database',
  input_schema: {
    type: 'object',
    properties: {
      sql: { type: 'string', description: 'The SQL query to execute' },
      database: { type: 'string', enum: ['users', 'orders', 'products'] }
    },
    required: ['sql', 'database']
  },
  execute: async ({ sql, database }) => {
    const db = getDatabase(database)
    const results = await db.query(sql)
    return JSON.stringify(results)
  }
}

const analyticsTool = {
  name: 'get_metrics',
  description: 'Get analytics metrics for a date range',
  input_schema: {
    type: 'object',
    properties: {
      startDate: { type: 'string', format: 'date' },
      endDate: { type: 'string', format: 'date' },
      metric: { type: 'string', enum: ['pageviews', 'users', 'revenue'] }
    },
    required: ['startDate', 'endDate', 'metric']
  },
  execute: async ({ startDate, endDate, metric }) => {
    const data = await analytics.getMetric(metric, startDate, endDate)
    return JSON.stringify(data)
  }
}

function AnalyticsAgent() {
  return (
    <ClaudeApi
      tools={[databaseTool, analyticsTool]}
      system="You are a data analyst. Use the tools to answer questions about our data."
      onFinished={(result) => console.log(result)}
    >
      What was our revenue trend last month compared to the previous month?
    </ClaudeApi>
  )
}
```

## Tool Execution Loop

ClaudeApi handles the tool execution loop automatically:

1. Sends prompt to Claude API
2. If Claude returns tool calls, executes your tool handlers
3. Sends tool results back to Claude
4. Repeats until Claude returns a final response

```tsx
const tool = {
  name: 'get_weather',
  description: 'Get current weather',
  input_schema: {
    type: 'object',
    properties: {
      city: { type: 'string' }
    },
    required: ['city']
  },
  execute: async ({ city }) => {
    // Called automatically when Claude uses the tool
    const weather = await weatherApi.get(city)
    return `${weather.temp}Â°F, ${weather.conditions}`
  }
}

<ClaudeApi tools={[tool]}>
  What's the weather in San Francisco and New York?
</ClaudeApi>
```

## Combining with Structural Components

ClaudeApi works with the same structural components as Claude:

```tsx
<ClaudeApi
  tools={[databaseTool, chartTool]}
  system="You are a business analyst"
>
  <Persona role="Senior Business Analyst">
    Expert in data analysis and visualization.
  </Persona>

  <Constraints>
    - Use charts for visual representation of trends
    - Include specific numbers in your analysis
    - Highlight actionable insights
  </Constraints>

  <Phase name="data-gathering">
    <Step>Query the relevant databases</Step>
    <Step>Aggregate the data by relevant dimensions</Step>
  </Phase>

  <Phase name="analysis">
    <Step>Identify trends and patterns</Step>
    <Step>Create visualizations</Step>
    <Step>Summarize findings</Step>
  </Phase>

  Analyze our Q4 sales performance.
</ClaudeApi>
```

## Error Handling

Handle tool execution errors gracefully:

```tsx
const robustTool = {
  name: 'fetch_data',
  description: 'Fetch data from external API',
  input_schema: { /* ... */ },
  execute: async (params) => {
    try {
      const data = await fetchExternalApi(params)
      return JSON.stringify(data)
    } catch (error) {
      // Return error info so Claude can handle it
      return JSON.stringify({
        error: true,
        message: error.message,
        suggestion: 'Try a different query or check parameters'
      })
    }
  }
}
```

## TypeScript

Full type definitions are available:

```tsx
import type { ClaudeApiProps, Tool } from 'smithers'

interface CustomResult {
  analysis: string
  recommendations: string[]
}

const myTool: Tool = {
  name: 'analyze',
  description: 'Analyze data',
  input_schema: {
    type: 'object',
    properties: { data: { type: 'string' } },
    required: ['data']
  },
  execute: async ({ data }) => {
    // Implementation
  }
}

function TypedAgent() {
  return (
    <ClaudeApi<CustomResult>
      tools={[myTool]}
      onFinished={(result) => {
        console.log(result.analysis)
        result.recommendations.forEach(r => console.log(r))
      }}
    >
      Analyze this...
    </ClaudeApi>
  )
}
```

## Related

<CardGroup cols={2}>
  <Card title="Claude" icon="cube" href="/components/claude">
    Agent SDK with built-in tools
  </Card>
  <Card title="executePlan" icon="play" href="/api-reference/execute-plan">
    Execute components programmatically
  </Card>
</CardGroup>
