---
title: Codex
description: OpenAI Codex CLI agent wrapper
---

# Codex

```tsx
<Codex model="o4-mini" fullAuto>
  Implement user authentication with JWT tokens.
</Codex>
```

Wraps OpenAI Codex CLI for code-focused AI agent tasks. Alternative to Claude with OpenAI's models.

```tsx
import { Codex } from "smithers-orchestrator"
```

## Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `children` | `ReactNode` | - | Prompt for the agent |
| `model` | `'o3' \| 'o4-mini' \| 'gpt-4o' \| 'gpt-4' \| string` | `'o4-mini'` | Model selection |
| `fullAuto` | `boolean` | `false` | Enable full-auto mode (approves edits, workspace write) |
| `sandboxMode` | `'read-only' \| 'workspace-write' \| 'danger-full-access'` | - | Sandbox mode for commands |
| `approvalPolicy` | `'untrusted' \| 'on-failure' \| 'on-request' \| 'never'` | - | Approval policy |
| `bypassSandbox` | `boolean` | `false` | Bypass all approvals and sandbox (EXTREMELY DANGEROUS) |
| `cwd` | `string` | - | Working directory |
| `skipGitRepoCheck` | `boolean` | `false` | Skip git repository check |
| `addDirs` | `string[]` | - | Additional directories that should be writable |
| `images` | `string[]` | - | Images to attach to the prompt |
| `profile` | `string` | - | Configuration profile from config.toml |
| `configOverrides` | `Record<string, unknown>` | - | Configuration overrides (key=value pairs) |
| `stopConditions` | `StopCondition[]` | - | Conditions that will stop the agent |
| `timeout` | `number` | `300000` | Timeout in ms |
| `schema` | `ZodType` | - | Structured output schema |
| `schemaRetries` | `number` | `2` | Maximum retries for schema validation failures |
| `onFinished` | `(result: AgentResult) => void` | - | Success callback |
| `onError` | `(error: Error) => void` | - | Error callback |
| `onProgress` | `(message: string) => void` | - | Progress callback |
| `onStreamPart` | `(part: SmithersStreamPart) => void` | - | Stream part callback for typed stream events |
| `reportingEnabled` | `boolean` | `false` | Enable database reporting for this agent |
| `validate` | `(result: AgentResult) => boolean \| Promise<boolean>` | - | Validation function for result |
| `retryOnValidationFailure` | `boolean` | `false` | Retry if validation fails |
| `maxRetries` | `number` | - | Maximum retry attempts |
| `tailLogCount` | `number` | `10` | Number of tail log entries during execution |
| `tailLogLines` | `number` | `10` | Number of lines per tail log entry |
| `middleware` | `SmithersMiddleware[]` | - | Middleware applied to execution |
| `jsonOutput` | `boolean` | `false` | Enable JSON output mode |

## With Structured Output

```tsx
import { z } from 'zod'

const reviewSchema = z.object({
  decision: z.enum(['approve', 'request_changes']),
  issues: z.array(z.object({
    severity: z.enum(['critical', 'major', 'minor']),
    file: z.string(),
    message: z.string()
  })),
  summary: z.string()
})

<Codex
  model="gpt-4"
  schema={reviewSchema}
  onFinished={(result) => console.log(result.structured)}
>
  Review this pull request
</Codex>
```

## In Fallback Chain

```tsx
<FallbackAgent>
  <Codex model="gpt-4-turbo">{prompt}</Codex>
  <Claude model="sonnet">{prompt}</Claude>
</FallbackAgent>
```

## Authentication

Smithers wraps the `codex` CLI, which supports two authentication methods:

### Option 1: ChatGPT/Codex Subscription (Recommended)

Use your existing ChatGPT Plus, Pro, or Team subscription. No API key required.

```bash
# One-time login - opens browser for OAuth
codex login
```

After login, Codex uses your subscription credits automatically.

### Option 2: API Key

Use OpenAI API credits directly:

```bash
export OPENAI_API_KEY="sk-..."
```

<Note>
If both are configured, the CLI uses the API key. To use subscription credits when an API key is set, unset the environment variable or use a separate shell session.
</Note>

## Related

<CardGroup cols={2}>
  <Card title="useCodex Hook" icon="bolt" href="/api-reference/use-codex">
    Custom rendering with the same execution
  </Card>
  <Card title="FallbackAgent" icon="shield-halved" href="/components/fallback-agent">
    Multi-provider failover
  </Card>
  <Card title="Claude" icon="robot" href="/components/claude">
    Primary agent
  </Card>
  <Card title="Gemini" icon="stars" href="/components/gemini">
    Google Gemini agent
  </Card>
</CardGroup>
