---
title: Debugging Playbook
description: Inspect, debug, and troubleshoot Smithers workflows
---

# Debugging Playbook

```bash
smithers db executions                    # List all
smithers db execution <id>                # View details
smithers db state --execution <id>        # View state
```

## Direct SQLite Inspection

```bash
sqlite3 .smithers/my-workflow/db.sqlite "SELECT * FROM tasks WHERE status = 'running'"
sqlite3 .smithers/my-workflow/db.sqlite "SELECT * FROM state ORDER BY updated_at DESC LIMIT 5"
```

## Claude Code Logs

Logs stored at `~/.claude/projects/<project-path>/sessions/`:
- `session.jsonl` - Full conversation
- `metadata.json` - Session metadata

Correlate with:
```tsx
<Claude onFinished={(r) => console.log("Session:", r.sessionId)}>
```

## Common Issues

**Workflow Stalls**
- No state change in `onFinished`
- Missing task completion call

Debug: `SELECT * FROM tasks WHERE status = 'running'`

**Phase Not Advancing**
- Step not completing
- No Steps in Phase
- `skipIf` returning wrong value

Debug: `SELECT * FROM steps WHERE phase_id = '<id>'`

**Crash Recovery Fails**
- Using `useState` instead of SQLite
- Not checking `db.execution.findIncomplete()`

Fix:
```tsx
const incomplete = db.execution.findIncomplete();
if (incomplete) executionId = incomplete.id;
```

## Key Tables

| Table | Purpose |
|-------|---------|
| `executions` | Workflow runs |
| `state` | Key-value storage |
| `phases` | Phase progress |
| `steps` | Step completion |
| `tasks` | Async tracking |
| `agents` | Agent logs |

## Upgrade

If issues persist, try upgrading to the latest version:

```bash
smithers upgrade
```

---

## Related

<CardGroup cols={2}>
  <Card title="Database Persistence" icon="database" href="/concepts/database-persistence" />
  <Card title="Claude Log Format" icon="file-lines" href="/guides/claude-log-format" />
</CardGroup>
