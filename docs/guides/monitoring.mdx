---
title: Monitoring & Logs
description: Smithers logging system, NDJSON streams, and output summarization
---

# Monitoring & Logs

```
.smithers/
├── logs/                          # Default log directory
└── executions/<id>/logs/
    ├── stream.ndjson              # NDJSON stream events
    └── stream.summary.json        # Event counts
```

## NDJSON Stream Format

```json
{"timestamp":1234567890,"type":"text-end","content":"..."}
{"timestamp":1234567891,"type":"tool-call","name":"Read","input":{}}
{"timestamp":1234567892,"type":"tool-result","output":"..."}
```

| Type | Description |
|------|-------------|
| `text-end` | Completed text block |
| `reasoning-end` | Completed reasoning |
| `tool-call` | Tool invocation |
| `tool-result` | Tool output |
| `error` | Error event |

## Summarization Config

| Variable | Default | Description |
|----------|---------|-------------|
| `SMITHERS_SUMMARY_THRESHOLD` | `50` | Line threshold |
| `SMITHERS_SUMMARY_CHAR_THRESHOLD` | `4000` | Char threshold |
| `SMITHERS_SUMMARY_MAX_CHARS` | `20000` | Max to summarizer |
| `SMITHERS_SUMMARY_MODEL` | `claude-3-haiku-20240307` | Model |

Without `ANTHROPIC_API_KEY`, outputs are truncated instead.

## LogWriter API

```tsx
import { LogWriter } from 'smithers-orchestrator'

const logger = new LogWriter('.smithers/logs', executionId)
logger.writeLog('agent-output', content, { agent: 'claude' })
logger.appendStreamPart('stream.ndjson', { type: 'tool-call', name: 'Read' })
logger.writeStreamSummary('stream', parts)
await logger.flushAllStreams()
```

## Inspecting Logs

```bash
cat .smithers/executions/<execution-id>/logs/stream.ndjson | jq
tail -f .smithers/logs/*.txt
```

## Related

<CardGroup cols={2}>
  <Card title="Debugging Playbook" icon="bug" href="/guides/debugging" />
  <Card title="Database Persistence" icon="database" href="/concepts/database-persistence" />
</CardGroup>
