---
title: smithers plan
description: Preview the XML plan without executing
---

# smithers plan

Preview the rendered XML plan without executing. Useful for debugging, testing, and understanding what an agent will do.

## Synopsis

```bash
smithers plan <file> [options]
```

## Arguments

<ParamField path="file" type="string" required>
  Path to the agent file (`.tsx` or `.mdx`).

  ```bash
  smithers plan src/agents/review.tsx
  smithers plan agents/research.mdx
  ```
</ParamField>

## Options

<ParamField path="--props, -p" type="string">
  JSON string of props to pass to the agent component.

  ```bash
  smithers plan agent.tsx --props '{"topic": "machine learning"}'
  smithers plan agent.tsx -p '{"files": ["src/index.ts"]}'
  ```
</ParamField>

<ParamField path="--output, -o" type="string">
  Write the plan XML to a file instead of stdout.

  ```bash
  smithers plan agent.tsx -o plan.xml
  smithers plan agent.tsx --output debug/current-plan.xml
  ```
</ParamField>

## Examples

### Basic Plan Preview

```bash
smithers plan review-agent.tsx --props '{"files": ["src/auth.ts"]}'
```

Output:
```xml
<claude tools="filesystem,grep">
  <constraints>
    - Focus on bugs and security issues
    - Be constructive, not pedantic
    - Ignore formatting (that's what linters are for)
  </constraints>

  Review these files for issues: src/auth.ts

  <output-format>
    Return JSON: { issues: [{ file, line, severity, message }] }
  </output-format>
</claude>
```

### Save Plan to File

```bash
smithers plan research-agent.tsx \
  --props '{"topic": "quantum computing"}' \
  --output plans/research-plan.xml
```

### Complex Multi-Phase Agent

```bash
smithers plan feature-team.tsx --props '{"feature": "user authentication"}'
```

Output (initial state):
```xml
<claude>
  <persona role="Software Architect">
    You are a senior software architect with expertise in system design.
  </persona>

  Design an implementation plan for: user authentication

  Break it into independent subtasks that can be worked on in parallel.

  <output-format schema='{"subtasks": [{"id": "string", "description": "string"}]}'>
    Return valid JSON matching the schema.
  </output-format>
</claude>
```

### Parallel Subagents

```bash
smithers plan parallel-research.tsx --props '{"topics": ["AI", "ML", "DL"]}'
```

Output:
```xml
<subagent name="researcher-AI">
  <claude tools="web-search">
    Research: AI
  </claude>
</subagent>
<subagent name="researcher-ML">
  <claude tools="web-search">
    Research: ML
  </claude>
</subagent>
<subagent name="researcher-DL">
  <claude tools="web-search">
    Research: DL
  </claude>
</subagent>
```

## Use Cases

<AccordionGroup>
  <Accordion title="Debugging prompts">
    See exactly what prompt will be sent to Claude. Verify that props and conditional logic produce the expected output.
  </Accordion>
  <Accordion title="Code review">
    Share plans with teammates before execution. "Here's what the agent will do - looks good?"
  </Accordion>
  <Accordion title="Testing">
    Write tests that assert on plan output without making API calls.

    ```tsx
    import { renderPlan } from '@evmts/smithers'

    test('renders correct plan', async () => {
      const xml = await renderPlan(<MyAgent topic="test" />)
      expect(xml).toContain('<phase name="research">')
      expect(xml).toContain('test')
    })
    ```
  </Accordion>
  <Accordion title="Documentation">
    Generate example plans for documentation or tutorials.
  </Accordion>
</AccordionGroup>

## Understanding the Output

The plan shows:

1. **Component hierarchy**: How your JSX maps to XML elements
2. **Props serialization**: How component props become XML attributes
3. **Children content**: The actual prompt text that will be sent
4. **Tool configuration**: Which tools are available to the agent

### Example Breakdown

```xml
<claude tools="filesystem,grep">      <!-- tools prop -->
  <persona role="Security Expert">    <!-- Persona component -->
    10 years experience...
  </persona>

  <constraints>                        <!-- Constraints component -->
    - Focus on OWASP Top 10
  </constraints>

  Audit the codebase...               <!-- Plain text children -->

  <output-format schema='...'>        <!-- OutputFormat with schema -->
    Return JSON...
  </output-format>
</claude>
```

## Programmatic Usage

Use `renderPlan` in code for the same functionality:

```tsx
import { renderPlan } from '@evmts/smithers'

async function previewAgent() {
  const xml = await renderPlan(
    <MyAgent topic="AI safety" depth={3} />
  )

  console.log(xml)

  // Or write to file
  await Bun.write('plan.xml', xml)
}
```

## Limitations

<Warning>
  The plan shows the **initial** render only. Multi-phase agents produce different plans as state changes. To see all phases, you need to actually execute the agent.
</Warning>

For stateful agents, the plan represents what will happen in Frame 1. Subsequent frames depend on Claude's responses updating state.

## Related Commands

<CardGroup cols={2}>
  <Card title="smithers run" icon="play" href="/cli/run">
    Execute the plan after preview
  </Card>
  <Card title="smithers init" icon="folder-plus" href="/cli/init">
    Create a new agent project
  </Card>
</CardGroup>
