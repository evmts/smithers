---
title: smithers run
description: Execute an agent file with plan preview and approval
---

# smithers run

Execute an agent file. By default, shows the plan and prompts for approval before execution.

## Synopsis

```bash
smithers run <file> [options]
```

## Arguments

<ParamField path="file" type="string" required>
  Path to the agent file (`.tsx` or `.mdx`).

  ```bash
  smithers run src/agents/review.tsx
  smithers run agents/research.mdx
  ```
</ParamField>

## Options

<ParamField path="--props, -p" type="string">
  JSON string of props to pass to the agent component.

  ```bash
  smithers run agent.tsx --props '{"topic": "AI safety", "depth": 3}'
  smithers run agent.tsx -p '{"files": ["src/auth.ts", "src/db.ts"]}'
  ```
</ParamField>

<ParamField path="--auto-approve, -y" type="boolean" default="false">
  Skip the plan approval prompt and execute immediately. Useful for CI/CD pipelines.

  ```bash
  smithers run agent.tsx --auto-approve
  smithers run agent.tsx -y
  ```
</ParamField>

<ParamField path="--verbose, -v" type="boolean" default="false">
  Show detailed execution logs including frame-by-frame progress.

  ```bash
  smithers run agent.tsx --verbose
  smithers run agent.tsx -v
  ```
</ParamField>

<ParamField path="--max-frames" type="number" default="100">
  Maximum number of execution frames before terminating. Prevents infinite loops.

  ```bash
  smithers run agent.tsx --max-frames 50
  ```
</ParamField>

<ParamField path="--timeout" type="number">
  Total execution timeout in milliseconds.

  ```bash
  smithers run agent.tsx --timeout 300000  # 5 minutes
  ```
</ParamField>

<ParamField path="--output, -o" type="string">
  Write the final output to a file instead of stdout.

  ```bash
  smithers run agent.tsx -o result.json
  smithers run agent.tsx --output reports/analysis.md
  ```
</ParamField>

## Examples

### Basic Execution

```bash
# Run with interactive approval
smithers run review-agent.tsx --props '{"repo": "my-org/my-repo"}'
```

Output:
```
┌─ Plan ─────────────────────────────────────────────────────┐
│                                                            │
│  <claude tools="filesystem,grep">                          │
│    <constraints>                                           │
│      - Focus on bugs and security issues                   │
│    </constraints>                                          │
│    Review the repository: my-org/my-repo                   │
│  </claude>                                                 │
│                                                            │
└────────────────────────────────────────────────────────────┘

? Execute this plan? (Y/n)
```

### CI/CD Pipeline

```bash
# Auto-approve for automation
smithers run agent.tsx \
  --props '{"branch": "main"}' \
  --auto-approve \
  --output result.json
```

### Debug Mode

```bash
# Verbose output for debugging
smithers run agent.tsx --verbose --props '{"debug": true}'
```

Output:
```
[Frame 1] Rendering...
[Frame 1] Plan:
<claude tools="filesystem">
  Research the topic...
</claude>

[Frame 1] Executing <claude>...
[Frame 1] Claude response received (1.2s)
[Frame 1] Calling onFinished callback
[Frame 1] State updated, scheduling re-render

[Frame 2] Rendering...
[Frame 2] Plan:
<claude tools="filesystem">
  Write report based on findings...
</claude>

[Frame 2] Executing <claude>...
[Frame 2] Complete

Total frames: 2
Total time: 4.7s
```

### With Timeout and Frame Limits

```bash
# Limit execution for safety
smithers run complex-agent.tsx \
  --max-frames 25 \
  --timeout 60000 \
  --props '{"task": "large analysis"}'
```

### MDX Files

```bash
# MDX agents work the same way
smithers run research.mdx --props '{"topic": "quantum computing"}'
```

## Exit Codes

| Code | Meaning |
|------|---------|
| 0 | Success |
| 1 | Execution error |
| 2 | Invalid arguments |
| 3 | File not found |
| 4 | User cancelled (declined approval) |
| 5 | Timeout exceeded |
| 6 | Max frames exceeded |

## Environment Variables

<ParamField path="ANTHROPIC_API_KEY" type="string" required>
  Your Anthropic API key. Required for execution.
</ParamField>

<ParamField path="SMITHERS_AUTO_APPROVE" type="boolean">
  Set to `true` to auto-approve by default.

  ```bash
  export SMITHERS_AUTO_APPROVE=true
  smithers run agent.tsx  # No approval prompt
  ```
</ParamField>

<ParamField path="SMITHERS_MAX_FRAMES" type="number">
  Default max frames limit.

  ```bash
  export SMITHERS_MAX_FRAMES=50
  ```
</ParamField>

## Interactive Approval

When not using `--auto-approve`, you'll see the plan and can:

- **Y/Enter**: Approve and execute
- **n**: Cancel execution

```
? Execute this plan? (Y/n)
```

## Related Commands

<CardGroup cols={2}>
  <Card title="smithers plan" icon="eye" href="/cli/plan">
    Preview the plan without executing
  </Card>
  <Card title="smithers init" icon="folder-plus" href="/cli/init">
    Scaffold a new agent project
  </Card>
</CardGroup>
