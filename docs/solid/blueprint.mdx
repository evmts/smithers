---
title: Solid Migration Blueprint
description: Step-by-step plan for moving Smithers to a Solid-based renderer
---

# Solid Migration Blueprint

This blueprint outlines how to migrate Smithers from React reconciler rendering to a Solid custom renderer while preserving the XML plan output and the Ralph Wiggum loop.

## Goals

- Keep the current Smithers API surface and XML plan output stable.
- Replace React reconciliation with Solid signals + a custom renderer.
- Preserve the Ralph Wiggum execution loop and node execution semantics.
- Enable simpler agent-to-agent state flow using signals.

## Non-goals

- Rewriting the Claude executors or MCP integration.
- Changing the XML schema or the plan serialization format.
- Shipping DOM or SSR features.

## Scope

- New `solid-smithers` renderer package.
- New `smithers/solid` entrypoint for users.
- CLI compatibility (plan rendering, execution) with the new renderer.
- Parity tests between React and Solid outputs.

## Milestones

### Phase 0: Discovery
- Identify minimal renderer operations needed for SmithersNode.
- Confirm Solid compiler configuration (`generate: "universal"`).
- Decide public API for `smithers/solid`.

### Phase 1: Renderer Prototype
- Implement a `solid-smithers` renderer using `solid-js/universal`.
- Render a minimal tree and serialize to XML.
- Verify text updates and conditional rendering with signals.

### Phase 2: API Parity
- Port Smithers components (Claude, Phase, Step, etc.) to the Solid entrypoint.
- Ensure all component props remain identical.
- Add TypeScript JSX runtime for `solid-smithers`.

### Phase 3: CLI Integration
- Add CLI support for Solid entrypoints (opt-in flag or file pragma).
- Ensure `smithers plan` uses Solid renderer when requested.
- Ensure `smithers run` executes the same plan output.

### Phase 4: Parity Testing
- Snapshot XML outputs for key examples.
- Execute plans and validate callbacks, state transitions, and mock mode.
- Validate Worktree/File node handling.

### Phase 5: Rollout
- Document migration path for users.
- Keep React renderer available until parity is confirmed.
- Decide deprecation plan if Solid becomes default.

## Risks and Mitigations

- **Signal update ordering differences**: Add determinism tests for plan output.
- **Renderer edge cases**: Build a minimal test suite for insert/remove/reorder.
- **JSX config friction**: Provide copy-paste compiler config for Babel/Vite.
- **CLI dual support**: Use explicit flags or file pragmas to avoid ambiguity.

## Rollback Plan

- Keep React renderer as default for CLI.
- Use a feature flag (`--renderer solid`) to opt into Solid.
- If parity fails, disable the flag and continue React-based rendering.

## Deliverables Checklist

- [ ] `solid-smithers` renderer package
- [ ] `smithers/solid` entrypoint
- [ ] Compiler config docs (Babel/Vite/TS)
- [ ] Parity test suite
- [ ] Migration guide for users
