# Review: 5c12ec1

**Commit:** 5c12ec1ff1b1feee70d548e1a3b7611d69d9dc85
**Message:** ✨ feat(context): add ClaudeProvider with rate limiting and usage tracking
**Date:** 2026-01-06 07:10:55 UTC

## Feedback

- `src/context/claude-provider.tsx`: `onRateLimited` casts `error.limitType` to `'rpm'|'itpm'|'otpm'`, but `RateLimitError` can be `'queue_full'|'timeout'`; this can pass an invalid type to consumers. Handle those explicitly (separate callback or skip) or widen the type.
- `src/context/usage-tracker.ts`: `waitForBudget` starts a `setInterval` but never clears it when `resume()` is called manually (e.g., via `onBudgetPaused`), leading to leaked timers. Track the interval ID and clear it in `resume()` and/or when the promise resolves.
- `src/context/claude-provider.tsx`: `rateLimit`/`usageLimit` prop changes after mount won’t update the existing `TokenBucketRateLimiter`/`UsageTracker` instances, so new limits are ignored. Either recreate on change or call `updateConfig`/`updateLimits` in an effect.
