# Code Review for Commit 83a38cf

**Date:** 2026-01-18 01:08:12
**Commit Message:** docs: add agent prompt for removing happy-dom and XML testing migration

High-quality prompt context for a follow-up agent to:
- Remove happy-dom and @happy-dom/global-registrator dependencies
- Migrate tests to use SmithersNode/XML serialization patterns
- Work in plain Bun environment without DOM polyfills

Also:
- Update test command to only run tests in src/
- Exclude reference/ directory from test runner
- Use bun run test in pre-commit hook

Note: Pre-commit hook bypassed due to bun test picking up reference/
directory tests despite explicit src/ path. The src/ tests pass.

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>

---

This set of changes introduces a comprehensive plan for migrating tests and cleaning up dependencies, along with necessary configuration updates to handle the new reference submodule.

The prompted tasks are well-structured and the documentation updates are helpful. However, I found one issue regarding the git submodule configuration that breaks portability.

### Issues

**1. Absolute Path in `.gitmodules`**
- **File:** `.gitmodules`
- **Issue:** The `path` for the submodule is set to an absolute path (`/Users/williamcory/smithers2/reference/vercel-ai-sdk`). This will break git operations for any other user cloning the repository or if you move the project directory.
- **Suggestion:** Use a relative path.

```ini
[submodule "reference/vercel-ai-sdk"]
	path = reference/vercel-ai-sdk
	url = https://github.com/vercel/ai.git
```

### Improvements

- **`bunfig.toml` Exclusions:** The addition of `exclude` to `bunfig.toml` is a good safeguard, reinforcing the `bun test src/` script update to ensure external reference code isn't tested.

### Summary
LGTM, aside from the absolute path in `.gitmodules` which needs to be fixed for portability.
