# Review: bd60553

**Commit:** bd605539a083760d67ab98d4049054b6915a9115
**Message:** ðŸ§ª test: add nested Claude execution tests
**Date:** 2026-01-06 01:34:15 UTC

## Feedback

Global test side effects: `process.env.SMITHERS_MOCK_MODE = 'true'` is set at module scope in `evals/nested-claude.test.tsx:15` and never restored, so it can leak into other test files and mask failures. Set it in `beforeAll`/`afterAll` (or `beforeEach`/`afterEach`) and restore the prior value.

Test hygiene: several tests call `root.unmount()` only on the happy path (e.g., `evals/nested-claude.test.tsx:31` and similar). If `render` throws, the root stays mounted and can leak state across tests. Wrap render/unmount in `try/finally` to guarantee cleanup.
